<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>


<body>
    <py-script>
        import textwrap

        def reflow(*args, **kwargs):
            content = Element("input-text").element.value
            width = int(Element("input-width").element.value)
            indent = int(Element("input-indent").element.value)
            text = " ".join(l.strip() for l in content.splitlines())
            text = textwrap.fill(text, width - indent)
            if indent > 0:
                text = textwrap.indent(text, ' ' * indent)
            display(text, target="display-write", append=False)
        
        reflow()
    </py-script>
    <div class="col-lg-6 mx-auto p-4 py-md-5">
        <h1>Text Reflow - PyScript</h1>
        <p>This app will take any text included in the textbox below, and wrap it to the provided width and indentation. It was created to help with formatting python docstrings so that descriptive text could be written normally, and then pasted into here before being put into a function.</p>
        <form class="form-floating">
            <div class="row">
                <div class="col form-floating">
                    <input type="number" class="py-input form-control mb-1" id="input-width" value="70" py-onClick="reflow()">
                    <label for="input-width">Width</label>
                </div>
                <div class="col form-floating">
                    <input type="number" class="py-input form-control mb-1" id="input-indent" value="4" py-onClick="reflow()">
                    <label for="input-indent">Indentation</label>
                </div>
            </div>
            <div>
                <label for="input-text" class="form-label">Input Text</label>
                <textarea id="input-text" class="py-input mb-3 form-control" style="height: 100px; width: 100%" placeholder="Paste text here" py-onKeyDown="reflow()"></textarea>
                <div id="input-text-help" class="form-text">
                    If you paste text and nothing happens, try pressing enter. This function is set to trigger on key down.
                </div>
            </div>    
        </form>
        <hr>
        <p class="lead">Output</p>
        <div class="card">
            <div class="card-text">
                <pre><code id="display-write"></code></pre>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>